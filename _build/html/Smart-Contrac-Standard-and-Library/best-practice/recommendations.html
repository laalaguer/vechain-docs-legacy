

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Recommendations &mdash; VeChain Documentation Legacy 1.0.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Design Patterns" href="design-patterns.html" />
    <link rel="prev" title="Smart contract development best practice" href="../best-practice.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> VeChain Documentation Legacy
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../VeChainThorBlockchain/index.html">VeChainThor Blockchain</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../VeChainThorBlockchain/overview.html">What is VeChainThor?</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../VeChainThorBlockchain/overview.html#business-friendly-meta-transaction-features">Business Friendly Meta-transaction Features</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../VeChainThorBlockchain/overview.html#proof-of-authority-poa">Proof of Authority (“PoA”)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../VeChainThorBlockchain/overview.html#governance">Governance</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../VeChainThorBlockchain/overview.html#economic-model">Economic Model</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../VeChainThorBlockchain/two.html">Two-token design</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../VeChainThorBlockchain/two.html#vet">VET</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../VeChainThorBlockchain/two.html#vtho">VTHO</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../VeChainThorBlockchain/block.html">Block</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../VeChainThorBlockchain/tx-model.html">Transaction Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../VeChainThorBlockchain/mpp.html">Multi-party Payment Protocol (MPP)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../VeChainThorBlockchain/mpp.html#functions-related-to-user">Functions related to <em>User</em></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../VeChainThorBlockchain/mpp.html#functions-related-to-the-credit-plan">Functions related to the <em>credit plan</em></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../VeChainThorBlockchain/mpp.html#functions-related-master">Functions related <em>Master</em></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../VeChainThorBlockchain/mpp.html#functions-related-to-sponsor">Functions related to <em>Sponsor</em></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../VeChainThorBlockchain/poa.html">Proof of Authority (PoA)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../VeChainThorBlockchain/poa.html#when">When</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../VeChainThorBlockchain/poa.html#who">Who</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../VeChainThorBlockchain/poa.html#am-status-updating">AM Status Updating</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../VeChainThorBlockchain/poa.html#trunk">Trunk</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../VeChainThorBlockchain/built-in.html">Built-in Smart Contracts</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../GetStarted/index.html">Get Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../GetStarted/how-to-node.html">How to deploy a VeChainThor node</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../GetStarted/docker.html">Docker</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../GetStarted/docker.html#run-vechainthor-authority-masternode-in-docker">Run VeChainThor Authority Masternode in docker</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../GetStarted/docker.html#run-node-in-docker">Run node in docker</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../GetStarted/aws.html">AWS Marketplace</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../GetStarted/aws.html#this-is-an-example-of-solo-node-deployment">This is an example of “solo node” deployment.</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../GetStarted/source.html">Source code</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../GetStarted/source.html#installation">Installation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../GetStarted/public.html">Public VeChainThor nodes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../GetStarted/how-to-deploy.html">How to deploy a smart contract</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../GetStarted/how-to-deploy.html#quick-start">Quick Start</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../GetStarted/how-to-develop.html">How to develop a dApp</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../GetStarted/how-to-1.html">Intro</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../GetStarted/how-to-1.html#whats-web-application"><strong>What’s Web Application?</strong></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../GetStarted/how-to-1.html#what-is-dapp"><strong>What is DApp?</strong></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../GetStarted/how-to-1.html#write-a-dapp-sync-and-connex"><strong>Write a DApp: Sync and Connex</strong></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../GetStarted/how-to-1.html#token-transfer-a-simple-dapp-in-javascript"><strong>Token Transfer: A Simple DApp in Javascript</strong></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../GetStarted/how-to-2.html">Components and Coding</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../GetStarted/how-to-2.html#preparation"><strong>Preparation</strong></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../GetStarted/how-to-2.html#setup-in-3-minutes"><strong>Setup in 3 minutes</strong></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../GetStarted/how-to-2.html#coding"><strong>Coding</strong></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../GetStarted/how-to-2.html#put-things-together"><strong>Put Things Together</strong></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../GetStarted/how-to-2.html#test-the-app"><strong>Test the App</strong></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../GetStarted/how-to-2.html#one-more-thing"><strong>One More Thing</strong></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../GetStarted/how-to-3.html">Setup &amp; Walk Around</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../GetStarted/how-to-3.html#setup-in-3-minutes"><strong>Setup in 3 minutes</strong></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../GetStarted/how-to-3.html#poke-around-familiar-with-sync"><strong>Poke around: Familiar with Sync</strong></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../GetStarted/how-to-3.html#play-with-connex-js-apis"><strong>Play with Connex.js APIs</strong></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../GetStarted/how-to-3.html#summary"><strong>Summary</strong></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Smart Contrac Standard and Library</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../best-practice.html">Smart contract development best practice</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../best-practice.html#vechainthor-solidity-the-right-way">VeChainThor Solidity The Right Way</a></li>
<li class="toctree-l3"><a class="reference internal" href="../best-practice.html#motivation">Motivation</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../best-practice.html#general-philosophy">General Philosophy</a><ul class="current">
<li class="toctree-l4 current"><a class="current reference internal" href="#">Recommendations</a></li>
<li class="toctree-l4"><a class="reference internal" href="design-patterns.html">Design Patterns</a></li>
<li class="toctree-l4"><a class="reference internal" href="security.html">Security</a></li>
<li class="toctree-l4"><a class="reference internal" href="resources.html">Resources</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../vip180-token.html">VIP180 fungible token</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../vip180-token.html#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../vip180-token.html#specification">Specification</a></li>
<li class="toctree-l3"><a class="reference internal" href="../vip180-token.html#methods">Methods</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../vip180-token.html#name">name</a></li>
<li class="toctree-l4"><a class="reference internal" href="../vip180-token.html#symbol">symbol</a></li>
<li class="toctree-l4"><a class="reference internal" href="../vip180-token.html#decimals">decimals</a></li>
<li class="toctree-l4"><a class="reference internal" href="../vip180-token.html#totalsupply">totalSupply</a></li>
<li class="toctree-l4"><a class="reference internal" href="../vip180-token.html#balanceof">balanceOf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../vip180-token.html#transfer">transfer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../vip180-token.html#transferfrom">transferFrom</a></li>
<li class="toctree-l4"><a class="reference internal" href="../vip180-token.html#approve">approve</a></li>
<li class="toctree-l4"><a class="reference internal" href="../vip180-token.html#allowance">allowance</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../vip180-token.html#events">Events</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../vip180-token.html#id1">Transfer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../vip180-token.html#approval">Approval</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../list-of-vip180-token.html">List of VIP180 tokens</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vip181-token.html">VIP181 non-fungible token</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../vip181-token.html#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../vip181-token.html#specification">Specification</a></li>
<li class="toctree-l3"><a class="reference internal" href="../vip181-token.html#methods">Methods</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../vip181-token.html#name">name</a></li>
<li class="toctree-l4"><a class="reference internal" href="../vip181-token.html#symbol">symbol</a></li>
<li class="toctree-l4"><a class="reference internal" href="../vip181-token.html#totalsupply">totalSupply</a></li>
<li class="toctree-l4"><a class="reference internal" href="../vip181-token.html#balanceof">balanceOf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../vip181-token.html#ownerof">ownerOf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../vip181-token.html#transferfrom">transferFrom</a></li>
<li class="toctree-l4"><a class="reference internal" href="../vip181-token.html#approve">approve</a></li>
<li class="toctree-l4"><a class="reference internal" href="../vip181-token.html#getapproved">getApproved</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../vip181-token.html#setapprovalforall">setApprovalForAll</a></li>
<li class="toctree-l3"><a class="reference internal" href="../vip181-token.html#isapprovedforall">isApprovedForAll</a></li>
<li class="toctree-l3"><a class="reference internal" href="../vip181-token.html#events">Events</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../vip181-token.html#transfer">Transfer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../vip181-token.html#approval">Approval</a></li>
<li class="toctree-l4"><a class="reference internal" href="../vip181-token.html#approvalforall">ApprovalForAll</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../vechain-thornode-contract.html">VeChainThor Node token contract</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../vechain-thornode-contract.html#getmetadata">getMetadata</a></li>
<li class="toctree-l3"><a class="reference internal" href="../vechain-thornode-contract.html#applyupgrade">applyUpgrade</a></li>
<li class="toctree-l3"><a class="reference internal" href="../vechain-thornode-contract.html#cancelupgrade">cancelUpgrade</a></li>
<li class="toctree-l3"><a class="reference internal" href="../vechain-thornode-contract.html#gettokenparams">getTokenParams</a></li>
<li class="toctree-l3"><a class="reference internal" href="../vechain-thornode-contract.html#idtoowner">idToOwner</a></li>
<li class="toctree-l3"><a class="reference internal" href="../vechain-thornode-contract.html#ownertoid">ownerToId</a></li>
<li class="toctree-l3"><a class="reference internal" href="../vechain-thornode-contract.html#createsaleauction">createSaleAuction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../vechain-thornode-contract.html#createdirectionalsaleauction">createDirectionalSaleAuction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../vechain-thornode-contract.html#bid">bid</a></li>
<li class="toctree-l3"><a class="reference internal" href="../vechain-thornode-contract.html#cancelauction">cancelAuction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../vechain-thornode-contract.html#addauctionwhitelist">addAuctionWhiteList</a></li>
<li class="toctree-l3"><a class="reference internal" href="../vechain-thornode-contract.html#removeauctionwhitelist">removeAuctionWhiteList</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../Connex-js/index.html">Connex-js</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Connex-js/connex.html">What is Connex?</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Connex-js/connex.html#introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Connex-js/connex.html#get-started">Get Started</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Connex-js/connex.html#vechain-app-bootstrapping">VeChain App Bootstrapping</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Connex-js/connex.html#install">Install</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Connex-js/connex.html#usage">Usage</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../Connex-js/connex.html#resource">Resource</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Connex-js/connex.html#architecture-explained">Architecture explained</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Connex-js/connex.html#faq">FAQ</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Connex-js/connex.html#typescript-complier-does-not-find-connex">TypeScript complier does not find Connex</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../Connex-js/connex.html#license">License</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../Connex-js/connex-api-reference.html">Connex API reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Connex-js/setup-your-connex-environment.html">Setup the Connex environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Connex-js/connex-framework.html">Connex Framework</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Connex-js/connex-framework.html#installation">Installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Connex-js/connex-framework.html#usage">Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Connex-js/connex-framework.html#see-also">See also</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Connex-js/connex-framework.html#driver-implementations">Driver implementations:</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Connex-js/connex-framework.html#connex-playground">Connex playground</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../Connex-js/connex-implementation-test.html">Connex implementation test</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Connex-js/connex-implementation-test.html#requirements">Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Connex-js/connex-implementation-test.html#project-setup">Project setup</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Connex-js/connex-implementation-test.html#compiles-and-hot-reloads-for-development">Compiles and hot-reloads for development</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Connex-js/connex-implementation-test.html#compiles-and-minifies-for-production">Compiles and minifies for production</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Connex-js/connex-implementation-test.html#run-your-tests">Run your tests</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Connex-js/connex-implementation-test.html#lints-and-fixes-files">Lints and fixes files</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Connex-js/connex-implementation-test.html#customize-configuration">Customize configuration</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../Connex-js/demo.html">Example Connex app</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Connex-js/demo/vechain-insight.html">Insight</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Connex-js/demo/vechain-insight.html#what-is-insight">What is Insight?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Connex-js/demo/vechain-insight.html#screenshots">Screenshots</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Connex-js/demo/vechain-insight.html#project-setup">Project setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Connex-js/demo/vechain-insight.html#contribute">Contribute</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../Connex-js/demo/inspector.html">Inspector</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Connex-js/demo/inspector.html#project-setup">Project setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Connex-js/demo/inspector.html#contribute">Contribute</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../Connex-js/demo/buy-me-a-coffee.html">Buy Me A Coffee</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Connex-js/demo/buy-me-a-coffee.html#generate-one-for-you">Generate One For You</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Connex-js/demo/buy-me-a-coffee.html#development">Development</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Connex-js/demo/buy-me-a-coffee.html#contribute">Contribute</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../Connex-js/demo/energy-station.html">Energy Station (testnet only)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Connex-js/demo/energy-station.html#what-is-energy-station">What is Energy Station</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Connex-js/demo/energy-station.html#concept">Concept</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Connex-js/demo/energy-station.html#deployment">Deployment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Connex-js/demo/energy-station.html#usage">Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Connex-js/demo/energy-station.html#contribute">Contribute</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../Development-Tools/index.html">Development Tools</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Development-Tools/java-sdk-introduction.html">Thor Java Client SDK?</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Development-Tools/java-sdk-introduction.html#get-started">Get Started</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Development-Tools/java-sdk-introduction.html#create-jar">Create JAR</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Development-Tools/java-sdk-introduction.html#add-jar-to-project">Add JAR to project</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../Development-Tools/java-sdk-introduction.html#license">License</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Development-Tools/java-sdk-introduction.html#set-blockchain-nodes-provider">Set blockchain nodes provider</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Development-Tools/java-sdk-introduction.html#you-can-find-the-clients-toolkit-under-the-directory">You can find the clients toolkit under the directory :</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Development-Tools/java-sdk-introduction.html#walletutils">WalletUtils</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Development-Tools/java-sdk-introduction.html#accountclient">AccountClient</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Development-Tools/java-sdk-introduction.html#transactionclient">TransactionClient</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Development-Tools/java-sdk-introduction.html#blockclient">BlockClient</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Development-Tools/java-sdk-introduction.html#logsclient">LogsClient</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Development-Tools/java-sdk-introduction.html#blockchainclient">BlockchainClient</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Development-Tools/java-sdk-introduction.html#prototypeclient">ProtoTypeClient</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Development-Tools/java-sdk-introduction.html#run-the-test">Run the test</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Development-Tools/java-sdk-introduction.html#java-console-approach">4. Java console approach</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../Development-Tools/thorify-introduction.html">Thorify</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Development-Tools/thorify-introduction.html#install">Install</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Development-Tools/thorify-introduction.html#usage">Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Development-Tools/thorify-introduction.html#web3-method-supported">Web3 method supported</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Development-Tools/thorify-introduction.html#send-transaction">Send Transaction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Development-Tools/thorify-introduction.html#documentation">Documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Development-Tools/thorify-introduction.html#play-with-multi-clause">Play with multi-clause</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Development-Tools/thorify-introduction.html#faq">FAQ</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Development-Tools/thorify-introduction.html#web3-gear-vs-thorify">Web3-Gear vs Thorify</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Development-Tools/thorify-introduction.html#how-do-i-send-vtho-token">How do I send VTHO token</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Development-Tools/thorify-introduction.html#multi-party-payment-protocol-or-sponsored-contract">Multi party payment protocol or sponsored contract</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Development-Tools/thorify-introduction.html#method-not-supported">Method not supported</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Development-Tools/thorify-introduction.html#subscriptions-support">Subscriptions support</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../Development-Tools/thorify-introduction.html#notes">Notes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Development-Tools/thorify-introduction.html#compatibility">Compatibility</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Development-Tools/thorify-introduction.html#license">License</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../Development-Tools/web3-gear.html">Web3-gear</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Development-Tools/web3-gear.html#installation">Installation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Development-Tools/web3-gear.html#on-os-x">On OS x</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Development-Tools/web3-gear.html#on-ubuntu">On Ubuntu</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Development-Tools/web3-gear.html#on-window">On Window</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../Development-Tools/web3-gear.html#run">Run</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Development-Tools/web3-gear.html#use-remix">Use Remix</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Development-Tools/web3-gear.html#use-truffle">Use Truffle</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../Development-Tools/dev-kit.html">Thor DevKit</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Development-Tools/dev-kit.html#installation">Installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Development-Tools/dev-kit.html#usage">Usage</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Development-Tools/dev-kit.html#crypto-methods">Crypto methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Development-Tools/dev-kit.html#rlp">RLP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Development-Tools/dev-kit.html#transaction">Transaction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Development-Tools/dev-kit.html#certificate">Certificate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Development-Tools/dev-kit.html#abi">ABI</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../Development-Tools/dev-kit.html#license">License</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../Development-Tools/ide.html">VIDE (VeChain-IDE)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Development-Tools/ide.html#installation">INSTALLATION:</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Development-Tools/ide.html#documentation">Documentation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../Development-Tools/consistency.html">Smart Contract Consistency Verification</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Development-Tools/consistency.html#install">Install</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Development-Tools/consistency.html#usage">Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Development-Tools/consistency.html#example">Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Development-Tools/consistency.html#download-compiler">Download Compiler</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Development-Tools/consistency.html#methods">Methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Development-Tools/consistency.html#references">References</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Development-Tools/consistency.html#license">License</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../Development-Tools/clients.html">Compatible Clients</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Development-Tools/clients/comet.html">Comet</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Development-Tools/clients/comet.html#what-is-comet">What is Comet?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Development-Tools/clients/comet.html#comet-compatibility-guide">Comet Compatibility Guide</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Development-Tools/clients/comet.html#requirements">Requirements</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Development-Tools/clients/comet.html#best-practices">Best Practices</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../Development-Tools/clients/sdk.html">Sync</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Development-Tools/clients/sdk.html#build-from-source">Build From Source</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Development-Tools/clients/sdk.html#contributing">Contributing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Development-Tools/clients/sdk.html#acknowledgement">Acknowledgement</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Development-Tools/clients/sdk.html#license">License</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Development-Tools/clients/sdk.html#user-guide">User Guide</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Development-Tools/clients/sdk.html#resources">Resources</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Development-Tools/clients/sdk.html#contribute">Contribute</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../Development-Tools/faucet.html">TestNet Faucet</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../Tutorials/index.html">Tutorials</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Tutorials/how-to-setup-the-development-environment.html">Setup the development environment using Truffle</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Tutorials/how-to-setup-the-development-environment.html#getting-started">Getting Started</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Tutorials/how-to-setup-the-development-environment.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Tutorials/how-to-setup-the-development-environment.html#development-stack">Development Stack</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Tutorials/how-to-setup-the-development-environment.html#installing">Installing</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Tutorials/how-to-setup-the-development-environment.html#running-the-vechainthor-local-node">Running the VeChainThor Local Node</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Tutorials/how-to-setup-the-development-environment.html#web3-gear">Web3-Gear</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Tutorials/how-to-setup-the-development-environment.html#truffle">Truffle</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../Tutorials/custom-network.html">Setup VeChainThor custom network</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Tutorials/custom-network.html#requirement">Requirement：</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Tutorials/custom-network.html#before-you-start">Before You Start</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Tutorials/custom-network.html#configure-your-genesis-file">Configure Your Genesis File</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Tutorials/custom-network.html#genesis-description-object">Genesis Description Object</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Tutorials/custom-network.html#authority">Authority</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Tutorials/custom-network.html#params">Params</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Tutorials/custom-network.html#launch-custom-network">Launch Custom Network</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Tutorials/custom-network/sample-customnetwork.html">Sample CustomNetwork</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../Tutorials/solo.html">Install VeChain SOLO development environment</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Tutorials/solo.html#part-1-install-vechain-thor-software">Part 1 — Install VeChain Thor software</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Tutorials/solo.html#part-1-1-install-debian-9-x64">Part 1.1 — Install Debian 9 x64</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Tutorials/solo.html#part-1-2-install-vechain-thor-node-software">Part 1.2 — Install VeChain Thor Node software</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Tutorials/solo.html#part-2-connect-sync-to-the-solo-network">Part 2 —Connect Sync to the SOLO network</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Tutorials/solo.html#part-2-1-install-sync-and-connect-it-to-the-solo-networks">Part 2.1 — Install Sync and connect it to the SOLO networks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Tutorials/solo.html#part-3-interact-with-the-solo-node-using-sync">Part 3 — Interact with the SOLO Node using Sync</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Tutorials/solo.html#part-3-1-send-vet-vthor-using-sync">Part 3.1 — Send VET/VTHOR using Sync</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Tutorials/solo.html#part-3-2-deploy-a-smart-contract-to-the-solo-network-through-sync">Part 3.2 — Deploy a smart contract to the SOLO network through Sync</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Tutorials/solo.html#part-3-3-interact-with-the-smart-contract">Part 3.3 — Interact with the Smart Contract</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../Tutorials/built-in.html">How to use built-in contracts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Tutorials/built-in.html#sample-code">Sample code</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Tutorials/built-in.html#thor-builtins">thor-builtins</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Tutorials/built-in.html#builtin-contracts">builtin contracts</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Tutorials/built-in.html#library-builtin">Library Builtin</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Tutorials/built-in.html#how-to-use-it">How to use it</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Tutorials/built-in.html#instance-contracts">instance contracts</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../Tutorials/vip180.html">How to add your VIP180 token to wallets, explorer and applications</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Tutorials/vip191.html">How to Integrate VIP-191</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Tutorials/vip191/intro.html">Intro</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Tutorials/vip191/intro.html#what-is-vip-191">What is VIP-191?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Tutorials/vip191/intro.html#why-is-vip-191-important">Why is VIP-191 Important?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Tutorials/vip191/intro.html#where-does-vip-191-come-to-play">Where does VIP-191 Come to Play?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Tutorials/vip191/intro.html#how-does-vip-191-work">How does VIP-191 Work?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../Tutorials/vip191/1.html">User’s side</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Tutorials/vip191/1.html#deploy-the-smart-contract">Deploy the Smart Contract</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Tutorials/vip191/1.html#build-a-transaction-body">Build a Transaction Body</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Tutorials/vip191/1.html#generate-a-user-signature">Generate a User Signature</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Tutorials/vip191/1.html#get-a-sponsor-signature">Get a Sponsor Signature</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Tutorials/vip191/1.html#next-steps">Next Steps</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../Tutorials/vip191/2.html">Sponsor’s side</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Tutorials/vip191/2.html#sponsors-server-code">Sponsor’s Server Code</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Tutorials/vip191/2.html#back-to-the-users-side">Back to the User’s side</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Tutorials/vip191/2.html#an-example-result">An Example Result</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Tutorials/vip191/2.html#conclusion">Conclusion</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../Turnkey-Solutions/index.html">Turnkey Solutions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Turnkey-Solutions/overview.html">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Turnkey-Solutions/wallet.html">The VeChainThor Wallet SDKs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Turnkey-Solutions/wallet/android.html">Wallet - Android</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Turnkey-Solutions/wallet/android.html#gradle-compiler-environment-android-studio">Gradle compiler environment（Android Studio）</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Turnkey-Solutions/wallet/android.html#api-reference">API Reference：</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Turnkey-Solutions/wallet/android.html#several-main-data-structures">Several main data structures</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Turnkey-Solutions/wallet/android.html#license">License</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../Turnkey-Solutions/wallet/ios.html">Wallet - iOS</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Turnkey-Solutions/wallet/ios.html#requires-ios-10">Requires iOS 10</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Turnkey-Solutions/wallet/ios.html#latest-version-1-0-0">Latest version 1.0.0</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Turnkey-Solutions/wallet/ios.html#support-installation-with-cocoapods">Support installation with CocoaPods</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Turnkey-Solutions/wallet/ios.html#set-up-the-node-environment-test-node-environment-main-node-environment-and-custom-node-environment">Set up the node environment. (<code class="docutils literal notranslate"><span class="pre">Test_Node</span> <span class="pre">environment</span></code> , <code class="docutils literal notranslate"><span class="pre">Main_Node</span> <span class="pre">environment</span></code> and custom node environment)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Turnkey-Solutions/wallet/ios.html#how-to-run-simple-demo">How to run simple demo</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Turnkey-Solutions/wallet/ios.html#api-reference">API Reference</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Turnkey-Solutions/wallet/ios.html#support-dapp-development-environment-in-webview-by-calling-class-walletdapphandle">Support DApp development environment in Webview by calling class: WalletDAppHandle</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../Turnkey-Solutions/vekey.html">VeKey based Secure Identity Turnkey Solution</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Turnkey-Solutions/vekey/mac.html">VeKey Bridge Tool Manual (Mac)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Turnkey-Solutions/vekey/mac.html#tool-feature-list">2.1. Tool Feature List</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Turnkey-Solutions/vekey/mac.html#requirements">2.2. Requirements</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Turnkey-Solutions/vekey/mac.html#install-vekey-bridge-tool">3.1. Install VeKey Bridge Tool</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Turnkey-Solutions/vekey/mac.html#vekey-bridge-tool-operation">3.2. VeKey Bridge Tool Operation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Turnkey-Solutions/vekey/mac.html#vekey-device-firmware-upgrade">3.3. VeKey device firmware upgrade</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Turnkey-Solutions/vekey/mac.html#vekey-bridge-tool-upgrade">3.4. VeKey Bridge Tool upgrade</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Turnkey-Solutions/vekey/mac.html#vekey-bridge-tool-menu">3.5. VeKey Bridge Tool Menu</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Turnkey-Solutions/vekey/mac.html#other-settings">3.6. Other settings</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../Turnkey-Solutions/vekey/windows.html">VeKey Bridge Tool Manual (Windows)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Turnkey-Solutions/vekey/windows.html#tool-feature-list">2.1. Tool Feature List</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Turnkey-Solutions/vekey/windows.html#requirements">2.2. Requirements</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Turnkey-Solutions/vekey/windows.html#install-vekey-bridge-tool">3.1. Install VeKey Bridge Tool</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Turnkey-Solutions/vekey/windows.html#vekey-bridge-tool-operation">3.2 VeKey Bridge Tool Operation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Turnkey-Solutions/vekey/windows.html#windows-tray-zone">3.3 Windows tray zone</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Turnkey-Solutions/vekey/windows.html#vekey-device-firmware-upgrade">3.4 VeKey device firmware upgrade</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Turnkey-Solutions/vekey/windows.html#vekey-bridge-tool-upgrade">3.5 VeKey Bridge Tool upgrade</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Turnkey-Solutions/vekey/windows.html#vekey-bridge-tool-menu">3.6 VeKey Bridge Tool Menu</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Turnkey-Solutions/vekey/windows.html#other-settings">3.7. Other settings</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../Turnkey-Solutions/hsm.html">HSM based Key Escrow Turnkey Solution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Turnkey-Solutions/share.html">VeKey based Threshold Signature Turnkey Solution</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../Hardware/index.html">Hardware</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Hardware/chips.html">Passive IoT</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Hardware/vekey.html">VeKey Manual</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Hardware/vekey.html#first-time-to-set-pin-code">First time to set PIN code</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Hardware/vekey.html#first-time-to-set-fingerprint">First time to set fingerprint</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Hardware/vekey.html#pin-code-verification">PIN code verification</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Hardware/vekey.html#fingerprint-verification">Fingerprint verification</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Hardware/vekey.html#daily-starting-up">Daily starting up</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Hardware/vekey.html#main-menu">Main menu</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Hardware/vekey.html#signature">Signature</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Hardware/vekey.html#about">About</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../Hardware/security.html">VeKey - Secure Identity Device</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../Contribute/index.html">Contribute</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">VeChain Documentation Legacy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content style-external-links">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Smart Contrac Standard and Library</a> &raquo;</li>
        
          <li><a href="../best-practice.html">Smart contract development best practice</a> &raquo;</li>
        
      <li>Recommendations</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/Smart-Contrac-Standard-and-Library/best-practice/recommendations.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="recommendations">
<h1>Recommendations<a class="headerlink" href="#recommendations" title="Permalink to this headline">¶</a></h1>
<blockquote>
<div>Security of a smart contract is more important than any other software or piece of code just because of the non-editable nature of it in general.</div></blockquote>
<div class="section" id="protocol-specific-recommendations">
<h2>Protocol specific recommendations<a class="headerlink" href="#protocol-specific-recommendations" title="Permalink to this headline">¶</a></h2>
<p>The following recommendations apply to the development of any contract system on VeChainThor network.</p>
<div class="section" id="external-calls">
<h3>External Calls<a class="headerlink" href="#external-calls" title="Permalink to this headline">¶</a></h3>
<div class="section" id="use-caution-when-making-external-calls">
<h4>Use caution when making external calls<a class="headerlink" href="#use-caution-when-making-external-calls" title="Permalink to this headline">¶</a></h4>
<p>Calls to untrusted contracts can introduce several unexpected risks or errors. External calls may execute malicious code in that contract <em>or</em> any other contract that it depends upon. As such, every external call should be treated as a potential security risk. When it is not possible, or undesirable to remove external calls, use the recommendations in the rest of this section to minimize the danger.</p>
</div>
<hr class="docutils" />
<div class="section" id="mark-untrusted-contracts">
<h4>Mark untrusted contracts<a class="headerlink" href="#mark-untrusted-contracts" title="Permalink to this headline">¶</a></h4>
<p>When interacting with external contracts, name your variables, methods, and contract interfaces in a way that makes it clear that interacting with them is potentially unsafe. This applies to your own functions that call external contracts.</p>
<div class="highlight-sol notranslate"><div class="highlight"><pre><span></span><span class="c1">// bad</span>
<span class="n">Bank</span><span class="p">.</span><span class="n">withdraw</span><span class="p">(</span><span class="mi">100</span><span class="p">);</span> <span class="c1">// Unclear whether trusted or untrusted</span>

<span class="kd">function</span> <span class="n">makeWithdrawal</span><span class="p">(</span><span class="kt">uint256</span> <span class="n">amount</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// Isn&#39;t clear that this function is potentially unsafe</span>
    <span class="n">Bank</span><span class="p">.</span><span class="n">withdraw</span><span class="p">(</span><span class="n">amount</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// good</span>
<span class="n">UntrustedBank</span><span class="p">.</span><span class="n">withdraw</span><span class="p">(</span><span class="mi">100</span><span class="p">);</span> <span class="c1">// untrusted external call</span>
<span class="n">TrustedBank</span><span class="p">.</span><span class="n">withdraw</span><span class="p">(</span><span class="mi">100</span><span class="p">);</span> <span class="c1">// external but trusted bank contract maintained by XYZ Corp</span>

<span class="kd">function</span> <span class="n">makeUntrustedWithdrawal</span><span class="p">(</span><span class="kt">uint256</span> <span class="n">amount</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">UntrustedBank</span><span class="p">.</span><span class="n">withdraw</span><span class="p">(</span><span class="n">amount</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="avoid-state-changes-after-external-calls">
<h4>Avoid state changes after external calls<a class="headerlink" href="#avoid-state-changes-after-external-calls" title="Permalink to this headline">¶</a></h4>
<p>Whether using <em>raw calls</em> (of the form <code class="docutils literal notranslate"><span class="pre">someAddress.call()</span></code>) or <em>contract calls</em> (of the form <code class="docutils literal notranslate"><span class="pre">ExternalContract.someMethod()</span></code>), assume that malicious code might execute. Even if <code class="docutils literal notranslate"><span class="pre">ExternalContract</span></code> is not malicious, malicious code can be executed by any contracts <em>it</em> calls.</p>
<p>One particular danger is malicious code may hijack the control flow, leading to vulnerabilities due to reentrancy. (See <a class="reference external" href="https://doc.vechainworld.io/page/security#section-reentrancy">Reentrancy</a> for a fuller discussion of this problem).</p>
<p>If you are making a call to an untrusted external contract, <em>avoid state changes after the call</em>. This pattern is also sometimes known as the <a class="reference external" href="http://solidity.readthedocs.io/en/develop/security-considerations.html?highlight=check%20effects#use-the-checks-effects-interactions-pattern">checks-effects-interactions pattern</a>.</p>
</div>
<hr class="docutils" />
<div class="section" id="be-aware-of-the-tradeoffs-between-send-transfer-and-call-value">
<h4>Be aware of the tradeoffs between <code class="docutils literal notranslate"><span class="pre">send()</span></code>, <code class="docutils literal notranslate"><span class="pre">transfer()</span></code>, and <code class="docutils literal notranslate"><span class="pre">call.value()()</span></code><a class="headerlink" href="#be-aware-of-the-tradeoffs-between-send-transfer-and-call-value" title="Permalink to this headline">¶</a></h4>
<p>When sending VET be aware of the relative tradeoffs between the use of
<code class="docutils literal notranslate"><span class="pre">someAddress.send()</span></code>, <code class="docutils literal notranslate"><span class="pre">someAddress.transfer()</span></code>, and <code class="docutils literal notranslate"><span class="pre">someAddress.call.value()()</span></code>.</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">someAddress.send()</span></code>and <code class="docutils literal notranslate"><span class="pre">someAddress.transfer()</span></code> are considered <em>safe</em> against <a class="reference external" href="https://doc.vechainworld.io/page/security#section-reentrancy">reentrancy</a>.
While these methods still trigger code execution, the called contract is
only given a stipend of 2,300 gas which is currently only enough to log an
event.</li>
<li><code class="docutils literal notranslate"><span class="pre">x.transfer(y)</span></code> is equivalent to <code class="docutils literal notranslate"><span class="pre">require(x.send(y));</span></code>, it will automatically revert if the send fails.</li>
<li><code class="docutils literal notranslate"><span class="pre">someAddress.call.value(y)()</span></code> will send the provided VET and trigger code execution.<br />The executed code is given all available gas for execution making this type of value transfer <em>unsafe</em> against reentrancy.</li>
</ul>
<p>Using <code class="docutils literal notranslate"><span class="pre">send()</span></code> or <code class="docutils literal notranslate"><span class="pre">transfer()</span></code> will prevent reentrancy but it does so at the cost of being incompatible with any contract whose fallback function requires more than 2,300 gas. It is also possible to use <code class="docutils literal notranslate"><span class="pre">someAddress.call.value(ethAmount).gas(gasAmount)()</span></code> to forward a custom amount of gas.</p>
<p>One pattern that attempts to balance this trade-off is to implement both
a <a class="reference external" href="https://doc.vechainworld.io/page/recommendations#section-favor-pull-over-push-for-external-calls"><em>push</em> and <em>pull</em></a> mechanism, using <code class="docutils literal notranslate"><span class="pre">send()</span></code> or <code class="docutils literal notranslate"><span class="pre">transfer()</span></code>
for the <em>push</em> component and <code class="docutils literal notranslate"><span class="pre">call.value()()</span></code> for the <em>pull</em> component.</p>
<p>It is worth pointing out that exclusive use of <code class="docutils literal notranslate"><span class="pre">send()</span></code> or <code class="docutils literal notranslate"><span class="pre">transfer()</span></code> for value transfers
does not itself make a contract safe against reentrancy but only makes those
specific value transfers safe against reentrancy.</p>
</div>
<hr class="docutils" />
<div class="section" id="handle-errors-in-external-calls">
<h4>Handle errors in external calls<a class="headerlink" href="#handle-errors-in-external-calls" title="Permalink to this headline">¶</a></h4>
<p>Solidity offers low-level call methods that work on raw addresses: <code class="docutils literal notranslate"><span class="pre">address.call()</span></code>, <code class="docutils literal notranslate"><span class="pre">address.callcode()</span></code>, <code class="docutils literal notranslate"><span class="pre">address.delegatecall()</span></code>, and <code class="docutils literal notranslate"><span class="pre">address.send()</span></code>. These low-level methods never throw an exception, but will return <code class="docutils literal notranslate"><span class="pre">false</span></code> if the call encounters an exception. On the other hand, <em>contract calls</em> (e.g., <code class="docutils literal notranslate"><span class="pre">ExternalContract.doSomething()</span></code>) will automatically propagate a throw (for example, <code class="docutils literal notranslate"><span class="pre">ExternalContract.doSomething()</span></code> will also <code class="docutils literal notranslate"><span class="pre">throw</span></code> if <code class="docutils literal notranslate"><span class="pre">doSomething()</span></code> throws).</p>
<p>If you choose to use the low-level call methods, make sure to handle the possibility that the call will fail, by checking the return value.</p>
<div class="highlight-sol notranslate"><div class="highlight"><pre><span></span><span class="c1">// bad</span>
<span class="n">someAddress</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="mi">55</span><span class="p">);</span>
<span class="n">someAddress</span><span class="p">.</span><span class="nf">call</span><span class="p">.</span><span class="n">value</span><span class="p">(</span><span class="mi">55</span><span class="p">)();</span> <span class="c1">// this is doubly dangerous, as it will forward all remaining gas and doesn&#39;t check for result</span>
<span class="n">someAddress</span><span class="p">.</span><span class="nf">call</span><span class="p">.</span><span class="n">value</span><span class="p">(</span><span class="mi">100</span><span class="p">)(</span><span class="kt">bytes4</span><span class="p">(</span><span class="nf">sha3</span><span class="p">(</span><span class="s">&quot;deposit()&quot;</span><span class="p">)));</span> <span class="c1">// if deposit throws an exception, the raw call() will only return false and transaction will NOT be reverted</span>

<span class="c1">// good</span>
<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">someAddress</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="mi">55</span><span class="p">))</span> <span class="p">{</span>
    <span class="c1">// handle failure code</span>
<span class="p">}</span>

<span class="n">ExternalContract</span><span class="p">(</span><span class="n">someAddress</span><span class="p">).</span><span class="n">deposit</span><span class="p">.</span><span class="n">value</span><span class="p">(</span><span class="mi">100</span><span class="p">);</span>
</pre></div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="favor-pull-over-push-for-external-calls">
<h4>Favor <em>pull</em> over <em>push</em> for external calls<a class="headerlink" href="#favor-pull-over-push-for-external-calls" title="Permalink to this headline">¶</a></h4>
<p>External calls can fail accidentally or deliberately. To minimize the damage caused by such failures, it is often better to isolate each external call into its own transaction that can be initiated by the recipient of the call. This is especially relevant for payments, where it is better to let users withdraw funds rather than push funds to them automatically. (This also reduces the chance of problems with the gas limit.)  Avoid combining multiple <code class="docutils literal notranslate"><span class="pre">send()</span></code> calls in a single transaction.</p>
<div class="highlight-sol notranslate"><div class="highlight"><pre><span></span><span class="c1">// bad</span>
<span class="kd">contract</span> <span class="n">auction</span> <span class="p">{</span>
    <span class="kt">address</span> <span class="n">highestBidder</span><span class="p">;</span>
    <span class="kt">uint256</span> <span class="n">highestBid</span><span class="p">;</span>

    <span class="kd">function</span> <span class="n">bid</span><span class="p">()</span> <span class="kr">payable</span> <span class="p">{</span>
        <span class="nf">require</span><span class="p">(</span><span class="nb">msg.value</span> <span class="o">&gt;=</span> <span class="n">highestBid</span><span class="p">);</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">highestBidder</span> <span class="o">!=</span> <span class="kt">address</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span> <span class="p">{</span>
            <span class="n">highestBidder</span><span class="p">.</span><span class="nf">transfer</span><span class="p">(</span><span class="n">highestBid</span><span class="p">);</span> <span class="c1">// if this call consistently fails, no one else can bid</span>
        <span class="p">}</span>

       <span class="n">highestBidder</span> <span class="o">=</span> <span class="nb">msg.sender</span><span class="p">;</span>
       <span class="n">highestBid</span> <span class="o">=</span> <span class="nb">msg.value</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// good</span>
<span class="kd">contract</span> <span class="n">auction</span> <span class="p">{</span>
    <span class="kt">address</span> <span class="n">highestBidder</span><span class="p">;</span>
    <span class="kt">uint256</span> <span class="n">highestBid</span><span class="p">;</span>
    <span class="kd">mapping</span><span class="p">(</span><span class="kt">address</span> <span class="o">=&gt;</span> <span class="kt">uint256</span><span class="p">)</span> <span class="n">refunds</span><span class="p">;</span>

    <span class="kd">function</span> <span class="n">bid</span><span class="p">()</span> <span class="kr">external</span> <span class="kr">payable</span> <span class="p">{</span>
        <span class="nf">require</span><span class="p">(</span><span class="nb">msg.value</span> <span class="o">&gt;=</span> <span class="n">highestBid</span><span class="p">);</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">highestBidder</span> <span class="o">!=</span> <span class="kt">address</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span> <span class="p">{</span>
            <span class="n">refunds</span><span class="p">[</span><span class="n">highestBidder</span><span class="p">]</span> <span class="o">+=</span> <span class="n">highestBid</span><span class="p">;</span> <span class="c1">// record the refund that this user can claim</span>
        <span class="p">}</span>

        <span class="n">highestBidder</span> <span class="o">=</span> <span class="nb">msg.sender</span><span class="p">;</span>
        <span class="n">highestBid</span> <span class="o">=</span> <span class="nb">msg.value</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">function</span> <span class="n">withdrawRefund</span><span class="p">()</span> <span class="kr">external</span> <span class="p">{</span>
        <span class="kt">uint256</span> <span class="n">refund</span> <span class="o">=</span> <span class="n">refunds</span><span class="p">[</span><span class="nb">msg.sender</span><span class="p">];</span>
        <span class="n">refunds</span><span class="p">[</span><span class="nb">msg.sender</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="nb">msg.sender</span><span class="p">.</span><span class="nf">transfer</span><span class="p">(</span><span class="n">refund</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="don-t-delegatecall-to-untrusted-code">
<h4>Don’t delegatecall to untrusted code<a class="headerlink" href="#don-t-delegatecall-to-untrusted-code" title="Permalink to this headline">¶</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">delegatecall</span></code> function is used to call functions from other contracts as if they belong to the caller contract. Thus the callee may change the state of the calling address. This may be insecure. An example below shows how using <code class="docutils literal notranslate"><span class="pre">delegatecall</span></code> can lead to the destruction of the contract and loss of its balance.</p>
<div class="highlight-sol notranslate"><div class="highlight"><pre><span></span><span class="kd">contract</span> <span class="n">Destructor</span>
<span class="p">{</span>
    <span class="kd">function</span> <span class="n">doWork</span><span class="p">()</span> <span class="kr">external</span>
    <span class="p">{</span>
        <span class="nb">selfdestruct</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">contract</span> <span class="n">Worker</span>
<span class="p">{</span>
    <span class="kd">function</span> <span class="n">doWork</span><span class="p">(</span><span class="kt">address</span> <span class="n">_internalWorker</span><span class="p">)</span> <span class="kr">public</span>
    <span class="p">{</span>
        <span class="c1">// unsafe</span>
        <span class="n">_internalWorker</span><span class="p">.</span><span class="nf">delegatecall</span><span class="p">(</span><span class="kt">bytes4</span><span class="p">(</span><span class="nf">keccak256</span><span class="p">(</span><span class="s">&quot;doWork()&quot;</span><span class="p">)));</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>If <code class="docutils literal notranslate"><span class="pre">Worker.doWork()</span></code> is called with the address of the deployed <code class="docutils literal notranslate"><span class="pre">Destructor</span></code> contract as an argument, the <code class="docutils literal notranslate"><span class="pre">Worker</span></code> contract will self-destruct. Delegate execution only to trusted contracts, and <strong>never to a user supplied address</strong>.</p>
<blockquote>
<div><strong>Warning</strong>: Don’t assume contracts are created with zero balance. An attacker can send VET to the address of a contract before it is created.  Contracts should not assume that its initial state contains a zero balance.  See <a class="reference external" href="https://github.com/ConsenSys/smart-contract-best-practices/issues/61">issue 61</a> for more details.</div></blockquote>
</div>
</div>
<hr class="docutils" />
<div class="section" id="remember-that-vet-can-be-forcibly-sent-to-an-account">
<h3>Remember that VET can be forcibly sent to an account<a class="headerlink" href="#remember-that-vet-can-be-forcibly-sent-to-an-account" title="Permalink to this headline">¶</a></h3>
<p>Beware of coding an invariant that strictly checks the balance of a contract.</p>
<p>An attacker can forcibly send VET to any account and this cannot be prevented (not even with a fallback function that does a <code class="docutils literal notranslate"><span class="pre">revert()</span></code>).</p>
<p>The attacker can do this by creating a contract, funding it with 1 wei, and invoking
<code class="docutils literal notranslate"><span class="pre">selfdestruct(victimAddress)</span></code>.  No code is invoked in <code class="docutils literal notranslate"><span class="pre">victimAddress</span></code>, so it
cannot be prevented. This is also true for</p>
</div>
<hr class="docutils" />
<div class="section" id="remember-that-on-chain-data-is-public">
<h3>Remember that on-chain data is public<a class="headerlink" href="#remember-that-on-chain-data-is-public" title="Permalink to this headline">¶</a></h3>
<p>Many applications require submitted data to be private up until some point in time in order to work. Games (eg. on-chain rock-paper-scissors) and auction mechanisms (eg. sealed-bid <a class="reference external" href="https://en.wikipedia.org/wiki/Vickrey_auction">Vickrey auctions</a>) are two major categories of examples. If you are building an application where privacy is an issue, make sure you avoid requiring users to publish information too early. The best strategy is to use <a class="reference external" href="https://en.wikipedia.org/wiki/Commitment_scheme">commitment schemes</a> with separate phases: first commit using the hash of the values and in a later phase revealing the values.</p>
<p>Examples:</p>
<ul class="simple">
<li>In rock paper scissors, require both players to submit a hash of their intended move first, then require both players to submit their move; if the submitted move does not match the hash throw it out.</li>
<li>In an auction, require players to submit a hash of their bid value in an initial phase (along with a deposit greater than their bid value), and then submit their auction bid value in the second phase.</li>
<li>When developing an application that depends on a random number generator, the order should always be <em>(1)</em> players submit moves, <em>(2)</em> random number generated, <em>(3)</em> players paid out. The method by which random numbers are generated is itself an area of active research; current best-in-class solutions include Bitcoin block headers (verified through http://btcrelay.org), hash-commit-reveal schemes (ie. one party generates a number, publishes its hash to “commit” to the value, and then reveals the value later) and <a class="reference external" href="http://github.com/randao/randao">RANDAO</a>. As Ethereum is a deterministic protocol, no variable within the protocol could be used as an unpredictable random number. Also be aware that miners are in some extent in control of the <code class="docutils literal notranslate"><span class="pre">block.blockhash()</span></code> value(<a class="reference external" href="https://ethereum.stackexchange.com/questions/419/when-can-blockhash-be-safely-used-for-a-random-number-when-would-it-be-unsafe">when-can-blockhash-be-safely-used-for-a-random-number-when-would-it-be-unsafe</a>)</li>
</ul>
</div>
<hr class="docutils" />
<div class="section" id="beware-of-the-possibility-that-some-participants-may-drop-offline-and-not-return">
<h3>Beware of the possibility that some participants may “drop offline” and not return<a class="headerlink" href="#beware-of-the-possibility-that-some-participants-may-drop-offline-and-not-return" title="Permalink to this headline">¶</a></h3>
<p>Do not make refund or claim processes dependent on a specific party performing a particular action with no other way of getting the funds out. For example, in a rock-paper-scissors game, one common mistake is to not make a payout until both players submit their moves; however, a malicious player can “grief” the other by simply never submitting their move - in fact, if a player sees the other player’s revealed move and determines that they lost, they have no reason to submit their own move at all. This issue may also arise in the context of state channel settlement. When such situations are an issue,</p>
<ol class="simple">
<li>provide a way of circumventing non-participating participants, perhaps through a time limit</li>
<li>consider adding an additional economic incentive for participants to submit information in all of the situations in which they are supposed to do so.</li>
</ol>
</div>
<hr class="docutils" />
<div class="section" id="beware-of-negation-of-the-most-negative-signed-integer">
<h3>Beware of negation of the most negative signed integer<a class="headerlink" href="#beware-of-negation-of-the-most-negative-signed-integer" title="Permalink to this headline">¶</a></h3>
<p>Solidity provides several types to work with signed integers. Like in most programming languages, in Solidity a signed integer with <code class="docutils literal notranslate"><span class="pre">N</span></code> bits can represent values from <code class="docutils literal notranslate"><span class="pre">-2^(N-1)</span></code> to <code class="docutils literal notranslate"><span class="pre">2^(N-1)-1</span></code>. This means that there is no positive equivalent for the <code class="docutils literal notranslate"><span class="pre">MIN_INT</span></code>. Negation is implemented as finding the two’s complement of a number, so the negation of the most negative number <a class="reference external" href="https://en.wikipedia.org/wiki/Two%27s_complement#Most_negative_number">will result in the same number</a>.</p>
<p>This is true for all signed integer types in Solidity (<code class="docutils literal notranslate"><span class="pre">int8</span></code>, <code class="docutils literal notranslate"><span class="pre">int16</span></code>, …, <code class="docutils literal notranslate"><span class="pre">int256</span></code>).</p>
<div class="highlight-sol notranslate"><div class="highlight"><pre><span></span><span class="kd">contract</span> <span class="n">Negation</span> <span class="p">{</span>
    <span class="kd">function</span> <span class="n">negate8</span><span class="p">(</span><span class="kt">int8</span> <span class="n">_i</span><span class="p">)</span> <span class="kr">public</span> <span class="kr">pure</span> <span class="k">returns</span><span class="p">(</span><span class="kt">int8</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="o">-</span><span class="n">_i</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">function</span> <span class="n">negate16</span><span class="p">(</span><span class="kt">int16</span> <span class="n">_i</span><span class="p">)</span> <span class="kr">public</span> <span class="kr">pure</span> <span class="k">returns</span><span class="p">(</span><span class="kt">int16</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="o">-</span><span class="n">_i</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kt">int8</span> <span class="kr">public</span> <span class="n">a</span> <span class="o">=</span> <span class="n">negate8</span><span class="p">(</span><span class="o">-</span><span class="mi">128</span><span class="p">);</span> <span class="c1">// -128</span>
    <span class="kt">int16</span> <span class="kr">public</span> <span class="n">b</span> <span class="o">=</span> <span class="n">negate16</span><span class="p">(</span><span class="o">-</span><span class="mi">128</span><span class="p">);</span> <span class="c1">// 128</span>
    <span class="kt">int16</span> <span class="kr">public</span> <span class="n">c</span> <span class="o">=</span> <span class="n">negate16</span><span class="p">(</span><span class="o">-</span><span class="mi">32768</span><span class="p">);</span> <span class="c1">// -32768</span>
<span class="p">}</span>
</pre></div>
</div>
<p>One way to handle this is to check the value of a variable before negation and throw if it’s equal to the <code class="docutils literal notranslate"><span class="pre">MIN_INT</span></code>. Another option is to make sure that the most negative number will never be achieved by using a type with a higher capacity (e.g. <code class="docutils literal notranslate"><span class="pre">int32</span></code> instead of <code class="docutils literal notranslate"><span class="pre">int16</span></code>).</p>
<p>A similar issue with <code class="docutils literal notranslate"><span class="pre">int</span></code> types occurs when <code class="docutils literal notranslate"><span class="pre">MIN_INT</span></code> is multiplied or divided by <code class="docutils literal notranslate"><span class="pre">-1</span></code>.</p>
</div>
</div>
<hr class="docutils" />
<div class="section" id="solidity-specific-recommendations">
<h2>Solidity specific recommendations<a class="headerlink" href="#solidity-specific-recommendations" title="Permalink to this headline">¶</a></h2>
<p>The following recommendations are specific to Solidity, but may also be instructive for developing smart contracts in other languages.</p>
<div class="section" id="enforce-invariants-with-assert">
<h3>Enforce invariants with <code class="docutils literal notranslate"><span class="pre">assert()</span></code><a class="headerlink" href="#enforce-invariants-with-assert" title="Permalink to this headline">¶</a></h3>
<p>An assert guard triggers when an assertion fails - such as an invariant property changing. For example, the token to VET issuance ratio, in a token issuance contract, may be fixed. You can verify that this is the case at all times with an <code class="docutils literal notranslate"><span class="pre">assert()</span></code>. Assert guards should often be combined with other techniques, such as pausing the contract and allowing upgrades. (Otherwise, you may end up stuck, with an assertion that is always failing.)</p>
<p>Example:</p>
<div class="highlight-sol notranslate"><div class="highlight"><pre><span></span><span class="kd">contract</span> <span class="n">Token</span> <span class="p">{</span>
    <span class="kt">uint256</span> <span class="kr">public</span> <span class="n">totalSupply</span><span class="p">;</span>
    <span class="kd">mapping</span><span class="p">(</span><span class="kt">address</span> <span class="o">=&gt;</span> <span class="kt">uint256</span><span class="p">)</span> <span class="kr">public</span> <span class="n">balanceOf</span><span class="p">;</span>

    <span class="kd">function</span> <span class="n">deposit</span><span class="p">()</span> <span class="kr">public</span> <span class="kr">payable</span> <span class="p">{</span>
        <span class="n">balanceOf</span><span class="p">[</span><span class="nb">msg.sender</span><span class="p">]</span> <span class="o">+=</span> <span class="nb">msg.value</span><span class="p">;</span>
        <span class="n">totalSupply</span> <span class="o">+=</span> <span class="nb">msg.value</span><span class="p">;</span>
        <span class="nf">assert</span><span class="p">(</span><span class="kt">address</span><span class="p">(</span><span class="nb">this</span><span class="p">).</span><span class="nb">balance</span> <span class="o">&gt;=</span> <span class="n">totalSupply</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Note that the assertion is <em>not</em> a strict equality of the balance because the contract can be forcibly sent VET without going through the <code class="docutils literal notranslate"><span class="pre">deposit()</span></code> function!</p>
</div>
<hr class="docutils" />
<div class="section" id="use-assert-require-revert-properly">
<h3>Use <code class="docutils literal notranslate"><span class="pre">assert()</span></code>, <code class="docutils literal notranslate"><span class="pre">require()</span></code>, <code class="docutils literal notranslate"><span class="pre">revert()</span></code> properly<a class="headerlink" href="#use-assert-require-revert-properly" title="Permalink to this headline">¶</a></h3>
<p>The convenience functions <strong>assert</strong> and <strong>require</strong> can be used to check for conditions and throw an exception if the condition is not met.</p>
<ul class="simple">
<li>The <strong>assert</strong> function should only be used to test for internal errors, and to check invariants.</li>
<li>The <strong>require</strong> function should be used to ensure valid conditions, such as inputs, or contract state variables are met, or to validate return values from calls to external contracts(<a class="reference external" href="https://solidity.readthedocs.io/en/latest/control-structures.html#error-handling-assert-require-revert-and-exceptions">https://solidity.readthedocs.io/en/latest/control-structures.html#error-handling-assert-require-revert-and-exceptions</a>).</li>
</ul>
<p>Following this paradigm allows formal analysis tools to verify that the invalid opcode can never be reached: meaning no invariants in the code are violated and that the code is formally verified.</p>
<div class="highlight-sol notranslate"><div class="highlight"><pre><span></span><span class="kr">pragma solidity</span> <span class="o">^</span><span class="mf">0.5</span><span class="p">.</span><span class="mi">0</span><span class="p">;</span>

<span class="kd">contract</span> <span class="n">Sharer</span> <span class="p">{</span>
    <span class="kd">function</span> <span class="n">sendHalf</span><span class="p">(</span><span class="kt">address</span> <span class="kr">payable</span> <span class="n">addr</span><span class="p">)</span> <span class="kr">public</span> <span class="kr">payable</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">uint256</span> <span class="nb">balance</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">require</span><span class="p">(</span><span class="nb">msg.value</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;Even value required.&quot;</span><span class="p">);</span> <span class="c1">// require() can have an optional message string</span>
        <span class="kt">uint256</span> <span class="n">balanceBeforeTransfer</span> <span class="o">=</span> <span class="kt">address</span><span class="p">(</span><span class="nb">this</span><span class="p">).</span><span class="nb">balance</span><span class="p">;</span>
        <span class="n">addr</span><span class="p">.</span><span class="nf">transfer</span><span class="p">(</span><span class="nb">msg.value</span> <span class="o">/</span> <span class="mi">2</span><span class="p">);</span>
        <span class="c1">// Since transfer throws an exception on failure and</span>
        <span class="c1">// cannot call back here, there should be no way for us to</span>
        <span class="c1">// still have half of the money.</span>
        <span class="nf">assert</span><span class="p">(</span><span class="kt">address</span><span class="p">(</span><span class="nb">this</span><span class="p">).</span><span class="nb">balance</span> <span class="o">==</span> <span class="n">balanceBeforeTransfer</span> <span class="o">-</span> <span class="nb">msg.value</span> <span class="o">/</span> <span class="mi">2</span><span class="p">);</span> <span class="c1">// used for internal error checking</span>
        <span class="k">return</span> <span class="kt">address</span><span class="p">(</span><span class="nb">this</span><span class="p">).</span><span class="nb">balance</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="use-modifiers-only-for-assertions">
<h3>Use modifiers only for assertions<a class="headerlink" href="#use-modifiers-only-for-assertions" title="Permalink to this headline">¶</a></h3>
<p>The code inside a modifier is usually executed before the function body, so any state changes or external calls will violate the <a class="reference external" href="https://solidity.readthedocs.io/en/develop/security-considerations.html#use-the-checks-effects-interactions-pattern">Checks-Effects-Interactions</a> pattern. Moreover, these statements may also remain unnoticed by the developer, as the code for modifier may be far from the function declaration. For example, an external call in modifier can lead to the reentrancy attack:</p>
<div class="highlight-sol notranslate"><div class="highlight"><pre><span></span><span class="kd">contract</span> <span class="n">Registry</span> <span class="p">{</span>
    <span class="kt">address</span> <span class="n">owner</span><span class="p">;</span>

    <span class="kd">function</span> <span class="n">isVoter</span><span class="p">(</span><span class="kt">address</span> <span class="n">_addr</span><span class="p">)</span> <span class="kr">external</span> <span class="k">returns</span><span class="p">(</span><span class="kt">bool</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Code</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">contract</span> <span class="n">Election</span> <span class="p">{</span>
    <span class="n">Registry</span> <span class="n">registry</span><span class="p">;</span>

    <span class="kd">modifier</span> <span class="n">isEligible</span><span class="p">(</span><span class="kt">address</span> <span class="n">_addr</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">require</span><span class="p">(</span><span class="n">registry</span><span class="p">.</span><span class="n">isVoter</span><span class="p">(</span><span class="n">_addr</span><span class="p">));</span>
        <span class="kr">_</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">function</span> <span class="n">vote</span><span class="p">()</span> <span class="kr">public</span> <span class="n">isEligible</span><span class="p">(</span><span class="nb">msg.sender</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Code</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In this case, the <code class="docutils literal notranslate"><span class="pre">Registry</span></code> contract can make a reentracy attack by calling <code class="docutils literal notranslate"><span class="pre">Election.vote()</span></code> inside <code class="docutils literal notranslate"><span class="pre">isVoter()</span></code>.</p>
<p>Use <a class="reference external" href="https://solidity.readthedocs.io/en/develop/contracts.html#function-modifiers">modifiers</a> to replace duplicate condition checks in multiple functions, such as <code class="docutils literal notranslate"><span class="pre">isOwner()</span></code>, otherwise use <code class="docutils literal notranslate"><span class="pre">require</span></code> or <code class="docutils literal notranslate"><span class="pre">revert</span></code> inside the function. This makes your smart contract code more readable and easier to audit.</p>
</div>
<hr class="docutils" />
<div class="section" id="beware-rounding-with-integer-division">
<h3>Beware rounding with integer division<a class="headerlink" href="#beware-rounding-with-integer-division" title="Permalink to this headline">¶</a></h3>
<p>All integer division rounds down to the nearest integer. If you need more precision, consider using a multiplier, or store both the numerator and denominator.</p>
<p>(In the future, Solidity will have a <a class="reference external" href="https://solidity.readthedocs.io/en/develop/types.html#fixed-point-numbers">fixed-point</a> type, which will make this easier.)</p>
<div class="highlight-sol notranslate"><div class="highlight"><pre><span></span><span class="c1">// bad</span>
<span class="kt">uint256</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">5</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span> <span class="c1">// Result is 2, all integer divison rounds DOWN to the nearest integer</span>
</pre></div>
</div>
<p>Using a multiplier prevents rounding down, this multiplier needs to be accounted for when working with x in the future:</p>
<div class="highlight-sol notranslate"><div class="highlight"><pre><span></span><span class="c1">// good</span>
<span class="kt">uint256</span> <span class="n">multiplier</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
<span class="kt">uint256</span> <span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span> <span class="o">*</span> <span class="n">multiplier</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>
</pre></div>
</div>
<p>Storing the numerator and denominator means you can calculate the result of <code class="docutils literal notranslate"><span class="pre">numerator/denominator</span></code> off-chain:</p>
<div class="highlight-sol notranslate"><div class="highlight"><pre><span></span><span class="c1">// good</span>
<span class="kt">uint256</span> <span class="n">numerator</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
<span class="kt">uint256</span> <span class="n">denominator</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
</pre></div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="be-aware-of-the-tradeoffs-between-abstract-contracts-and-interfaces">
<h3>Be aware of the tradeoffs between <strong>abstract contracts</strong> and <strong>interfaces</strong><a class="headerlink" href="#be-aware-of-the-tradeoffs-between-abstract-contracts-and-interfaces" title="Permalink to this headline">¶</a></h3>
<p>Both interfaces and abstract contracts provide one with a customizable and re-usable approach for smart contracts. Interfaces, which were introduced in Solidity 0.4.11, are similar to abstract contracts but cannot have any functions implemented. Interfaces also have limitations such as not being able to access storage or inherit from other interfaces which generally makes abstract contracts more practical. Although, interfaces are certainly useful for designing contracts prior to implementation. Additionally, it is important to keep in mind that if a contract inherits from an abstract contract it must implement all non-implemented functions via overriding or it will be abstract as well.</p>
</div>
<hr class="docutils" />
<div class="section" id="fallback-function">
<h3>Fallback Function<a class="headerlink" href="#fallback-function" title="Permalink to this headline">¶</a></h3>
<div class="section" id="keep-fallback-function-simple">
<h4>Keep fallback function simple<a class="headerlink" href="#keep-fallback-function-simple" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="http://solidity.readthedocs.io/en/latest/contracts.html#fallback-function">Fallback function</a> is called when a contract is sent a message with no arguments (or when no function matches), and only has access to 2,300 gas when called from a <code class="docutils literal notranslate"><span class="pre">.send()</span></code> or <code class="docutils literal notranslate"><span class="pre">.transfer()</span></code>. If you wish to be able to receive VET from a <code class="docutils literal notranslate"><span class="pre">.send()</span></code> or <code class="docutils literal notranslate"><span class="pre">.transfer()</span></code>, the most you can do in a fallback function is log an event. Use a proper function if a computation of more gas is required.</p>
<div class="highlight-sol notranslate"><div class="highlight"><pre><span></span><span class="c1">// bad</span>
<span class="kd">function</span><span class="p">()</span> <span class="kr">public</span> <span class="kr">payable</span> <span class="p">{</span>
    <span class="n">balances</span><span class="p">[</span><span class="nb">msg.sender</span><span class="p">]</span> <span class="o">+=</span> <span class="nb">msg.value</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// good</span>
<span class="kd">function</span> <span class="n">deposit</span><span class="p">()</span> <span class="kr">external</span> <span class="kr">payable</span> <span class="p">{</span>
    <span class="n">balances</span><span class="p">[</span><span class="nb">msg.sender</span><span class="p">]</span> <span class="o">+=</span> <span class="nb">msg.value</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">function</span><span class="p">()</span> <span class="kr">public</span> <span class="kr">payable</span> <span class="p">{</span>
    <span class="nf">require</span><span class="p">(</span><span class="nb">msg.data</span><span class="p">.</span><span class="n">length</span> <span class="o">==</span> <span class="mi">0</span><span class="p">);</span>
    <span class="kr">emit</span> <span class="n">LogDepositReceived</span><span class="p">(</span><span class="nb">msg.sender</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="check-data-length-in-fallback-function">
<h4>Check data length in fallback function<a class="headerlink" href="#check-data-length-in-fallback-function" title="Permalink to this headline">¶</a></h4>
<p>Since the <a class="reference external" href="http://solidity.readthedocs.io/en/latest/contracts.html#fallback-function">fallback function</a> is not only called for plain VET transfers (without data) but also when no other function matches, you should check that the data is empty if the fallback function is intended to be used only for the purpose of logging received VET. Otherwise, callers will not notice if your contract is used incorrectly and functions that do not exist are called.</p>
<div class="highlight-sol notranslate"><div class="highlight"><pre><span></span><span class="c1">// bad</span>
<span class="kd">function</span><span class="p">()</span> <span class="kr">public</span> <span class="kr">payable</span> <span class="p">{</span>
    <span class="kr">emit</span> <span class="n">LogDepositReceived</span><span class="p">(</span><span class="nb">msg.sender</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// good</span>
<span class="kd">function</span><span class="p">()</span> <span class="kr">public</span> <span class="kr">payable</span> <span class="p">{</span>
    <span class="nf">require</span><span class="p">(</span><span class="nb">msg.data</span><span class="p">.</span><span class="n">length</span> <span class="o">==</span> <span class="mi">0</span><span class="p">);</span>
    <span class="kr">emit</span> <span class="n">LogDepositReceived</span><span class="p">(</span><span class="nb">msg.sender</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="explicitly-mark-payable-functions-and-state-variables">
<h3>Explicitly mark payable functions and state variables<a class="headerlink" href="#explicitly-mark-payable-functions-and-state-variables" title="Permalink to this headline">¶</a></h3>
<p>Starting from Solidity <code class="docutils literal notranslate"><span class="pre">0.4.0</span></code>, every function that is receiving VET must use <code class="docutils literal notranslate"><span class="pre">payable</span></code> modifier, otherwise if the transaction has <code class="docutils literal notranslate"><span class="pre">msg.value</span> <span class="pre">&gt;</span> <span class="pre">0</span></code> will revert (except when forced).</p>
<p>Declare variables and especially function arguments as <code class="docutils literal notranslate"><span class="pre">address</span> <span class="pre">payable</span></code>, if you want to call <code class="docutils literal notranslate"><span class="pre">transfer</span></code> on them. You can use <code class="docutils literal notranslate"><span class="pre">.transfer(..)</span></code> and <code class="docutils literal notranslate"><span class="pre">.send(..)</span></code> on <code class="docutils literal notranslate"><span class="pre">address</span> <span class="pre">payable</span></code>, but not on <code class="docutils literal notranslate"><span class="pre">address</span></code>. You can use a low-level <code class="docutils literal notranslate"><span class="pre">.call(..)</span></code> on both <code class="docutils literal notranslate"><span class="pre">address</span></code> and <code class="docutils literal notranslate"><span class="pre">address</span> <span class="pre">payable</span></code>, even if you attach value to it. <a class="reference external" href="https://ethereum.stackexchange.com/questions/64108/whats-the-difference-between-address-and-address-payable">This is not recommended</a>.</p>
<blockquote>
<div><strong>Note</strong>: Something that might not be obvious: The <code class="docutils literal notranslate"><span class="pre">payable</span></code> modifier only applies to calls from <em>external</em> contracts. If I call a non-payable function in the payable function in the same contract, the non-payable function won’t fail, though <code class="docutils literal notranslate"><span class="pre">msg.value</span></code> is still set.</div></blockquote>
</div>
<div class="section" id="explicitly-mark-visibility-in-functions-and-state-variables">
<h3>Explicitly mark visibility in functions and state variables<a class="headerlink" href="#explicitly-mark-visibility-in-functions-and-state-variables" title="Permalink to this headline">¶</a></h3>
<p>Explicitly label the visibility of functions and state variables. Functions can be specified as being <code class="docutils literal notranslate"><span class="pre">external</span></code>, <code class="docutils literal notranslate"><span class="pre">public</span></code>, <code class="docutils literal notranslate"><span class="pre">internal</span></code> or <code class="docutils literal notranslate"><span class="pre">private</span></code>. Please understand the differences between them, for example, <code class="docutils literal notranslate"><span class="pre">external</span></code> may be sufficient instead of <code class="docutils literal notranslate"><span class="pre">public</span></code>. For state variables, <code class="docutils literal notranslate"><span class="pre">external</span></code> is not possible. Labeling the visibility explicitly will make it easier to catch incorrect assumptions about who can call the function or access the variable.</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">External</span></code> functions are part of the contract interface. An external function <code class="docutils literal notranslate"><span class="pre">f</span></code> cannot be called internally (i.e. <code class="docutils literal notranslate"><span class="pre">f()</span></code> does not work, but <code class="docutils literal notranslate"><span class="pre">this.f()</span></code> works). External functions are sometimes more efficient when they receive large arrays of data.</li>
<li><code class="docutils literal notranslate"><span class="pre">Public</span></code> functions are part of the contract interface and can be either called internally or via messages. For public state variables, an automatic getter function (see below) is generated.</li>
<li><code class="docutils literal notranslate"><span class="pre">Internal</span></code> functions and state variables can only be accessed internally, without using <code class="docutils literal notranslate"><span class="pre">this</span></code>.</li>
<li><code class="docutils literal notranslate"><span class="pre">Private</span></code> functions and state variables are only visible for the contract they are defined in and not in derived contracts.</li>
</ul>
<blockquote>
<div><strong>Note</strong>: Everything that is inside a contract is visible to all observers external to the blockchain, even <code class="docutils literal notranslate"><span class="pre">Private</span></code> variables(<a class="reference external" href="https://solidity.readthedocs.io/en/develop/contracts.html?#visibility-and-getters">https://solidity.readthedocs.io/en/develop/contracts.html?#visibility-and-getters</a>).</div></blockquote>
<div class="highlight-sol notranslate"><div class="highlight"><pre><span></span><span class="c1">// bad</span>
<span class="kt">uint256</span> <span class="n">x</span><span class="p">;</span> <span class="c1">// the default is internal for state variables, but it should be made explicit</span>
<span class="kd">function</span> <span class="n">buy</span><span class="p">()</span> <span class="p">{</span> <span class="c1">// the default is public</span>
    <span class="c1">// public code</span>
<span class="p">}</span>

<span class="c1">// good</span>
<span class="kt">uint256</span> <span class="kr">private</span> <span class="n">y</span><span class="p">;</span>
<span class="kd">function</span> <span class="n">buy</span><span class="p">()</span> <span class="kr">external</span> <span class="p">{</span>
    <span class="c1">// only callable externally or using this.buy()</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="n">utility</span><span class="p">()</span> <span class="kr">public</span> <span class="p">{</span>
    <span class="c1">// callable externally, as well as internally: changing this code requires thinking about both cases.</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="n">internalAction</span><span class="p">()</span> <span class="kr">internal</span> <span class="p">{</span>
    <span class="c1">// internal code</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="lock-pragmas-to-specific-compiler-version">
<h3>Lock pragmas to specific compiler version<a class="headerlink" href="#lock-pragmas-to-specific-compiler-version" title="Permalink to this headline">¶</a></h3>
<p>Contracts should be deployed with the same compiler version and flags that they have been tested the most with. Locking the pragma helps ensure that contracts do not accidentally get deployed using, for example, the latest compiler which may have higher risks of undiscovered bugs. Contracts may also be deployed by others and the pragma indicates the compiler version intended by the original authors.</p>
<div class="highlight-sol notranslate"><div class="highlight"><pre><span></span><span class="c1">// bad</span>
<span class="kr">pragma solidity</span> <span class="o">^</span><span class="mf">0.4</span><span class="p">.</span><span class="mi">4</span><span class="p">;</span>


<span class="c1">// good</span>
<span class="kr">pragma solidity</span> <span class="mf">0.4</span><span class="p">.</span><span class="mi">4</span><span class="p">;</span>
</pre></div>
</div>
<p>Note: a floating pragma version (ie. <code class="docutils literal notranslate"><span class="pre">^0.4.25</span></code>) will compile fine with <code class="docutils literal notranslate"><span class="pre">0.4.26-nightly.2018.9.25</span></code>, however nightly builds should <strong>NEVER</strong> be used to compile code for production.</p>
<blockquote>
<div><strong>Warning</strong>: Pragma statements can be allowed to float when a contract is intended for consumption by other developers, as in the case with contracts in a library or EthPM package. Otherwise, the developer would need to manually update the pragma in order to compile locally.</div></blockquote>
</div>
<hr class="docutils" />
<div class="section" id="use-events-to-monitor-contract-activity">
<h3>Use events to monitor contract activity<a class="headerlink" href="#use-events-to-monitor-contract-activity" title="Permalink to this headline">¶</a></h3>
<p>It can be useful to have a way to monitor the contract’s activity after it was deployed. One way to accomplish this is to look at all transactions of the contract, however that may be insufficient, as message calls between contracts are not recorded in the blockchain. Moreover, it shows only the input parameters, not the actual changes being made to the state. Also events could be used to trigger functions in the user interface.</p>
<div class="highlight-sol notranslate"><div class="highlight"><pre><span></span><span class="kd">contract</span> <span class="n">Charity</span> <span class="p">{</span>
    <span class="kd">mapping</span><span class="p">(</span><span class="kt">address</span> <span class="o">=&gt;</span> <span class="kt">uint256</span><span class="p">)</span> <span class="n">balances</span><span class="p">;</span>

    <span class="kd">function</span> <span class="n">donate</span><span class="p">()</span> <span class="kr">public</span> <span class="kr">payable</span> <span class="p">{</span>
        <span class="n">balances</span><span class="p">[</span><span class="nb">msg.sender</span><span class="p">]</span> <span class="o">+=</span> <span class="nb">msg.value</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">contract</span> <span class="n">Game</span> <span class="p">{</span>
    <span class="kd">function</span> <span class="n">buyCoins</span><span class="p">()</span> <span class="kr">public</span> <span class="kr">payable</span> <span class="p">{</span>
        <span class="c1">// 5% goes to charity</span>
        <span class="n">charity</span><span class="p">.</span><span class="n">donate</span><span class="p">.</span><span class="n">value</span><span class="p">(</span><span class="nb">msg.value</span> <span class="o">/</span> <span class="mi">20</span><span class="p">)();</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Here, <code class="docutils literal notranslate"><span class="pre">Game</span></code> contract will make an internal call to <code class="docutils literal notranslate"><span class="pre">Charity.donate()</span></code>. This transaction won’t appear in the external transaction list of <code class="docutils literal notranslate"><span class="pre">Charity</span></code>, but only visible in the internal transactions.</p>
<p>An event is a convenient way to log something that happened in the contract. Events that were emitted stay in the blockchain along with the other contract data and they are available for future audit. Here is an improvement to the example above, using events to provide a history of the Charity’s donations.</p>
<div class="highlight-sol notranslate"><div class="highlight"><pre><span></span><span class="kd">contract</span> <span class="n">Charity</span> <span class="p">{</span>
    <span class="c1">// define event</span>
    <span class="kd">event</span> <span class="n">LogDonate</span><span class="p">(</span><span class="kt">uint256</span> <span class="n">_amount</span><span class="p">);</span>

    <span class="kd">mapping</span><span class="p">(</span><span class="kt">address</span> <span class="o">=&gt;</span> <span class="kt">uint256</span><span class="p">)</span> <span class="n">balances</span><span class="p">;</span>

    <span class="kd">function</span> <span class="n">donate</span><span class="p">()</span> <span class="kr">public</span> <span class="kr">payable</span> <span class="p">{</span>
        <span class="n">balances</span><span class="p">[</span><span class="nb">msg.sender</span><span class="p">]</span> <span class="o">+=</span> <span class="nb">msg.value</span><span class="p">;</span>
        <span class="c1">// emit event</span>
        <span class="kr">emit</span> <span class="n">LogDonate</span><span class="p">(</span><span class="nb">msg.value</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">contract</span> <span class="n">Game</span> <span class="p">{</span>
    <span class="kd">function</span> <span class="n">buyCoins</span><span class="p">()</span> <span class="kr">public</span> <span class="kr">payable</span> <span class="p">{</span>
        <span class="c1">// 5% goes to charity</span>
        <span class="n">charity</span><span class="p">.</span><span class="n">donate</span><span class="p">.</span><span class="n">value</span><span class="p">(</span><span class="nb">msg.value</span> <span class="o">/</span> <span class="mi">20</span><span class="p">)();</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Here, all transactions that go through the <code class="docutils literal notranslate"><span class="pre">Charity</span></code> contract, either directly or not, will show up in the event list of that contract along with the amount of donated money.</p>
</div>
<hr class="docutils" />
<div class="section" id="be-aware-that-built-ins-can-be-shadowed">
<h3>Be aware that ‘Built-ins’ can be shadowed<a class="headerlink" href="#be-aware-that-built-ins-can-be-shadowed" title="Permalink to this headline">¶</a></h3>
<p>It is currently possible to <a class="reference external" href="https://en.wikipedia.org/wiki/Variable_shadowing">shadow</a> built-in globals in Solidity. This allows contracts to override the functionality of built-ins such as <code class="docutils literal notranslate"><span class="pre">msg</span></code> and <code class="docutils literal notranslate"><span class="pre">revert()</span></code>. Although this <a class="reference external" href="https://github.com/ethereum/solidity/issues/1249">is intended</a>, it can mislead users of a contract as to the contract’s true behavior.</p>
<div class="highlight-sol notranslate"><div class="highlight"><pre><span></span><span class="kd">contract</span> <span class="n">PretendingToRevert</span> <span class="p">{</span>
    <span class="kd">function</span> <span class="nf">revert</span><span class="p">()</span> <span class="kr">internal</span> <span class="kr">constant</span> <span class="p">{}</span>
<span class="p">}</span>

<span class="kd">contract</span> <span class="n">ExampleContract</span> <span class="kr">is</span> <span class="n">PretendingToRevert</span> <span class="p">{</span>
    <span class="kd">function</span> <span class="n">somethingBad</span><span class="p">()</span> <span class="kr">public</span> <span class="p">{</span>
        <span class="nf">revert</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Contract users (and auditors) should be aware of the full smart contract source code of any application they intend to use.</p>
</div>
<div class="section" id="avoid-using-tx-origin">
<h3>Avoid using <code class="docutils literal notranslate"><span class="pre">tx.origin</span></code><a class="headerlink" href="#avoid-using-tx-origin" title="Permalink to this headline">¶</a></h3>
<p>Avoid using <code class="docutils literal notranslate"><span class="pre">tx.origin</span></code> for authorization, another contract can have a method which will call your contract (where the user has some funds for instance) and your contract will authorize that transaction as your address is in <code class="docutils literal notranslate"><span class="pre">tx.origin</span></code>.</p>
<div class="highlight-sol notranslate"><div class="highlight"><pre><span></span><span class="kd">contract</span> <span class="n">MyContract</span> <span class="p">{</span>

    <span class="kt">address</span> <span class="n">owner</span><span class="p">;</span>

    <span class="kd">function</span> <span class="n">MyContract</span><span class="p">()</span> <span class="kr">public</span> <span class="p">{</span>
        <span class="n">owner</span> <span class="o">=</span> <span class="nb">msg.sender</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">function</span> <span class="n">sendTo</span><span class="p">(</span><span class="kt">address</span> <span class="n">receiver</span><span class="p">,</span> <span class="kt">uint256</span> <span class="n">amount</span><span class="p">)</span> <span class="kr">public</span> <span class="p">{</span>
        <span class="nf">require</span><span class="p">(</span><span class="nb">tx.origin</span> <span class="o">==</span> <span class="n">owner</span><span class="p">);</span>
        <span class="n">receiver</span><span class="p">.</span><span class="nf">transfer</span><span class="p">(</span><span class="n">amount</span><span class="p">);</span>
    <span class="p">}</span>

<span class="p">}</span>

<span class="kd">contract</span> <span class="n">AttackingContract</span> <span class="p">{</span>

    <span class="n">MyContract</span> <span class="n">myContract</span><span class="p">;</span>
    <span class="kt">address</span> <span class="n">attacker</span><span class="p">;</span>

    <span class="kd">constructor</span><span class="p">(</span><span class="kt">address</span> <span class="n">myContractAddress</span><span class="p">)</span> <span class="kr">public</span> <span class="p">{</span>
        <span class="n">myContract</span> <span class="o">=</span> <span class="n">MyContract</span><span class="p">(</span><span class="n">myContractAddress</span><span class="p">);</span>
        <span class="n">attacker</span> <span class="o">=</span> <span class="nb">msg.sender</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">function</span><span class="p">()</span> <span class="kr">public</span> <span class="p">{</span>
        <span class="n">myContract</span><span class="p">.</span><span class="n">sendTo</span><span class="p">(</span><span class="n">attacker</span><span class="p">,</span> <span class="nb">msg.sender</span><span class="p">.</span><span class="nb">balance</span><span class="p">);</span>
    <span class="p">}</span>

<span class="p">}</span>
</pre></div>
</div>
<p>You should use <code class="docutils literal notranslate"><span class="pre">msg.sender</span></code> for authorization (if another contract calls your contract <code class="docutils literal notranslate"><span class="pre">msg.sender</span></code> will be the address of the contract and not the address of the user who called the contract).</p>
<p>You can read more about it here: <a class="reference external" href="https://solidity.readthedocs.io/en/develop/security-considerations.html#tx-origin">Solidity docs</a></p>
<p>It’s also worth mentioning that by using <code class="docutils literal notranslate"><span class="pre">tx.origin</span></code> you’re limiting interoperability between contracts because the contract that uses tx.origin cannot be used by another contract as a contract can’t be the <code class="docutils literal notranslate"><span class="pre">tx.origin</span></code>.</p>
</div>
<hr class="docutils" />
<div class="section" id="timestamp-dependence">
<h3>Timestamp Dependence<a class="headerlink" href="#timestamp-dependence" title="Permalink to this headline">¶</a></h3>
<p>There are three main considerations when using a timestamp to execute a critical function in a contract, especially when actions involve fund transfer.</p>
<div class="section" id="timestamp-manipulation">
<h4>Timestamp Manipulation<a class="headerlink" href="#timestamp-manipulation" title="Permalink to this headline">¶</a></h4>
<p>Be aware that the timestamp of the block can be manipulated by a miner. Consider this contract:</p>
<div class="highlight-sol notranslate"><div class="highlight"><pre><span></span><span class="kt">uint256</span> <span class="kr">constant</span> <span class="kr">private</span> <span class="n">salt</span> <span class="o">=</span>  <span class="nb">block.timestamp</span><span class="p">;</span>

<span class="kd">function</span> <span class="n">random</span><span class="p">(</span><span class="kt">uint</span> <span class="n">Max</span><span class="p">)</span> <span class="kr">constant</span> <span class="kr">private</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">uint256</span> <span class="n">result</span><span class="p">){</span>
    <span class="c1">//get the best seed for randomness</span>
    <span class="kt">uint256</span> <span class="n">x</span> <span class="o">=</span> <span class="n">salt</span> <span class="o">*</span> <span class="mi">100</span><span class="o">/</span><span class="n">Max</span><span class="p">;</span>
    <span class="kt">uint256</span> <span class="n">y</span> <span class="o">=</span> <span class="n">salt</span> <span class="o">*</span> <span class="nb">block.number</span><span class="o">/</span><span class="p">(</span><span class="n">salt</span> <span class="o">%</span> <span class="mi">5</span><span class="p">)</span> <span class="p">;</span>
    <span class="kt">uint256</span> <span class="n">seed</span> <span class="o">=</span> <span class="nb">block.number</span><span class="o">/</span><span class="mi">3</span> <span class="o">+</span> <span class="p">(</span><span class="n">salt</span> <span class="o">%</span> <span class="mi">300</span><span class="p">)</span> <span class="o">+</span> <span class="n">Last_Payout</span> <span class="o">+</span> <span class="n">y</span><span class="p">;</span>
    <span class="kt">uint256</span> <span class="n">h</span> <span class="o">=</span> <span class="kt">uint256</span><span class="p">(</span><span class="nb">block.blockhash</span><span class="p">(</span><span class="n">seed</span><span class="p">));</span>

    <span class="k">return</span> <span class="kt">uint256</span><span class="p">((</span><span class="n">h</span> <span class="o">/</span> <span class="n">x</span><span class="p">))</span> <span class="o">%</span> <span class="n">Max</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span> <span class="c1">//random number between 1 and Max</span>
<span class="p">}</span>
</pre></div>
</div>
<p>When the contract uses the timestamp to seed a random number, the miner can actually post a timestamp within 15 seconds of the block being validated, effectively allowing the miner to precompute an option more favorable to their chances in the lottery. Timestamps are not random and should not be used in that context.</p>
</div>
</div>
<hr class="docutils" />
<div class="section" id="multiple-inheritance-caution">
<h3>Multiple Inheritance Caution<a class="headerlink" href="#multiple-inheritance-caution" title="Permalink to this headline">¶</a></h3>
<p>When utilizing multiple inheritance in Solidity, it is important to understand how the compiler composes the inheritance graph.</p>
<div class="highlight-sol notranslate"><div class="highlight"><pre><span></span><span class="kd">contract</span> <span class="n">Final</span> <span class="p">{</span>
    <span class="kt">uint256</span> <span class="kr">public</span> <span class="n">a</span><span class="p">;</span>
    
    <span class="kd">constructor</span><span class="p">(</span><span class="kt">uint256</span> <span class="n">f</span><span class="p">)</span> <span class="kr">public</span> <span class="p">{</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">f</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">contract</span> <span class="n">B</span> <span class="kr">is</span> <span class="n">Final</span> <span class="p">{</span>
    <span class="kt">int256</span> <span class="kr">public</span> <span class="n">fee</span><span class="p">;</span>

    <span class="kd">constructor</span><span class="p">(</span><span class="kt">uint256</span> <span class="n">f</span><span class="p">)</span> <span class="n">Final</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="kr">public</span> <span class="p">{}</span>

    <span class="kd">function</span> <span class="n">setFee</span><span class="p">()</span> <span class="kr">public</span> <span class="p">{</span>
        <span class="n">fee</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">contract</span> <span class="n">C</span> <span class="kr">is</span> <span class="n">Final</span> <span class="p">{</span>
    <span class="kt">int256</span> <span class="kr">public</span> <span class="n">fee</span><span class="p">;</span>

    <span class="kd">constructor</span><span class="p">(</span><span class="kt">uint256</span> <span class="n">f</span><span class="p">)</span> <span class="n">Final</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="kr">public</span> <span class="p">{}</span>

    <span class="kd">function</span> <span class="n">setFee</span><span class="p">()</span> <span class="kr">public</span> <span class="p">{</span>
        <span class="n">fee</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">contract</span> <span class="n">A</span> <span class="kr">is</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">()</span> <span class="kr">public</span> <span class="n">B</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="n">C</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">setFee</span><span class="p">();</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>When a contract is deployed, the compiler will <em>linearize</em> the inheritance from right to left (after the keyword <em>is</em> the parents are listed from the most base-like to the most derived). Here is contract A’s linearization:</p>
<p><strong>Final &lt;- B &lt;- C &lt;- A</strong></p>
<p>The consequence of the linearization will yield a <code class="docutils literal notranslate"><span class="pre">fee</span></code> value of 5, since C is the most derived contract. This may seem obvious, but imagine scenarios where C is able to shadow crucial functions, reorder boolean clauses, and cause the developer to write exploitable contracts. Static analysis currently does not raise issue with overshadowed functions, so it must be manually inspected.</p>
<p>For more on security and inheritance, check out this <a class="reference external" href="https://pdaian.com/blog/solidity-anti-patterns-fun-with-inheritance-dag-abuse/">article</a></p>
</div>
<hr class="docutils" />
<div class="section" id="use-interface-type-instead-of-the-address-for-type-safety">
<h3>Use interface type instead of the address for type safety<a class="headerlink" href="#use-interface-type-instead-of-the-address-for-type-safety" title="Permalink to this headline">¶</a></h3>
<p>When a function takes a contract address as an argument, it is better to pass an interface or contract type rather than raw <code class="docutils literal notranslate"><span class="pre">address</span></code>. If the function is called elsewhere within the source code, the compiler it will provide additional type safety guarantees.</p>
<p>Here we see two alternatives:</p>
<div class="highlight-sol notranslate"><div class="highlight"><pre><span></span><span class="kd">contract</span> <span class="n">Validator</span> <span class="p">{</span>
    <span class="kd">function</span> <span class="n">validate</span><span class="p">(</span><span class="kt">uint256</span><span class="p">)</span> <span class="kr">external</span> <span class="k">returns</span><span class="p">(</span><span class="kt">bool</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">contract</span> <span class="n">TypeSafeAuction</span> <span class="p">{</span>
    <span class="c1">// good</span>
    <span class="kd">function</span> <span class="n">validateBet</span><span class="p">(</span><span class="n">Validator</span> <span class="n">_validator</span><span class="p">,</span> <span class="kt">uint256</span> <span class="n">_value</span><span class="p">)</span> <span class="kr">internal</span> <span class="k">returns</span><span class="p">(</span><span class="kt">bool</span><span class="p">)</span> <span class="p">{</span>
        <span class="kt">bool</span> <span class="n">valid</span> <span class="o">=</span> <span class="n">_validator</span><span class="p">.</span><span class="n">validate</span><span class="p">(</span><span class="n">_value</span><span class="p">);</span>
        <span class="k">return</span> <span class="n">valid</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">contract</span> <span class="n">TypeUnsafeAuction</span> <span class="p">{</span>
    <span class="c1">// bad</span>
    <span class="kd">function</span> <span class="n">validateBet</span><span class="p">(</span><span class="kt">address</span> <span class="n">_addr</span><span class="p">,</span> <span class="kt">uint256</span> <span class="n">_value</span><span class="p">)</span> <span class="kr">internal</span> <span class="k">returns</span><span class="p">(</span><span class="kt">bool</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">Validator</span> <span class="n">validator</span> <span class="o">=</span> <span class="n">Validator</span><span class="p">(</span><span class="n">_addr</span><span class="p">);</span>
        <span class="kt">bool</span> <span class="n">valid</span> <span class="o">=</span> <span class="n">validator</span><span class="p">.</span><span class="n">validate</span><span class="p">(</span><span class="n">_value</span><span class="p">);</span>
        <span class="k">return</span> <span class="n">valid</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The benefits of using the <code class="docutils literal notranslate"><span class="pre">TypeSafeAuction</span></code> contract above can then be seen from the following example. If <code class="docutils literal notranslate"><span class="pre">validateBet()</span></code> is called with an <code class="docutils literal notranslate"><span class="pre">address</span></code> argument, or a contract type other than <code class="docutils literal notranslate"><span class="pre">Validator</span></code>, the compiler will throw this error:</p>
<div class="highlight-sol notranslate"><div class="highlight"><pre><span></span><span class="kd">contract</span> <span class="n">NonValidator</span><span class="p">{}</span>

<span class="kd">contract</span> <span class="n">Auction</span> <span class="kr">is</span> <span class="n">TypeSafeAuction</span> <span class="p">{</span>
    <span class="n">NonValidator</span> <span class="n">nonValidator</span><span class="p">;</span>

    <span class="kd">function</span> <span class="n">bet</span><span class="p">(</span><span class="kt">uint256</span> <span class="n">_value</span><span class="p">)</span> <span class="p">{</span>
        <span class="kt">bool</span> <span class="n">valid</span> <span class="o">=</span> <span class="n">validateBet</span><span class="p">(</span><span class="n">nonValidator</span><span class="p">,</span> <span class="n">_value</span><span class="p">);</span> <span class="c1">// TypeError: Invalid type for argument in function call.</span>
                                                        <span class="c1">// Invalid implicit conversion from contract NonValidator</span>
                                                        <span class="c1">// to contract Validator requested.</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="avoid-using-extcodesize-to-check-for-externally-owned-accounts">
<h3>Avoid using <code class="docutils literal notranslate"><span class="pre">extcodesize</span></code> to check for Externally Owned Accounts<a class="headerlink" href="#avoid-using-extcodesize-to-check-for-externally-owned-accounts" title="Permalink to this headline">¶</a></h3>
<p>The following modifier (or a similar check) is often used to verify whether a call was made from an externally owned account (EOA) or a contract account:</p>
<div class="highlight-sol notranslate"><div class="highlight"><pre><span></span>// bad
modifier isNotContract(address _a) {
    uint256 size;
    assembly { size := extcodesize(_a) }
    require(size == 0);
    _;
}
</pre></div>
</div>
<p>The idea is straight forward: if an address contains code, it’s not an EOA but a contract account. However, <strong>a contract does not have source code available during construction</strong>. This means that while the constructor is running, it can make calls to other contracts, but <code class="docutils literal notranslate"><span class="pre">extcodesize</span></code> for its address returns zero. Below is a minimal example that shows how this check can be circumvented:</p>
<div class="highlight-sol notranslate"><div class="highlight"><pre><span></span>contract OnlyForEOA {    
    uint256 public flag;

    // bad
    modifier isNotContract(address _a){
        uint256 size;
        assembly { size := extcodesize(_a) }
        require(size == 0);
        _;
    }

    function setFlag(uint256 i) public isNotContract(msg.sender) {
        flag = i;
    }
}

contract FakeEOA {
    constructor(address _a) public {
        OnlyForEOA c = OnlyForEOA(_a);
        c.setFlag(1);
    }
}
</pre></div>
</div>
<p>Because contract addresses can be pre-computed, this check could also fail if it checks an address which is empty at block <code class="docutils literal notranslate"><span class="pre">n</span></code>, but which has a contract deployed to it at some block greater than <code class="docutils literal notranslate"><span class="pre">n</span></code>.</p>
<p>This issue is nuanced.</p>
<p>If your goal is to prevent other contracts from being able to call your contract, the <code class="docutils literal notranslate"><span class="pre">extcodesize</span></code> check is probably sufficient. An alternative approach is to check the value of <code class="docutils literal notranslate"><span class="pre">(tx.origin</span> <span class="pre">==</span> <span class="pre">msg.sender)</span></code>, though this also <a class="reference external" href="https://doc.vechainworld.io/page/recommendations#section-avoid-using-tx-origin-">has drawbacks</a>.</p>
<p>There may be other situations in which the <code class="docutils literal notranslate"><span class="pre">extcodesize</span></code> check serves your purpose. Describing all of them here is out of scope. Understand the underlying behaviors of the EVM and use your judgement.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="design-patterns.html" class="btn btn-neutral float-right" title="Design Patterns" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../best-practice.html" class="btn btn-neutral float-left" title="Smart contract development best practice" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, VeChain Developers

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>